(function(a,b){function f(a,b){return b?c(a&255)+f(a>>8,b-1):""}function g(a,b){return b?g(a>>8,b-1)+c(255-a&255):""}function h(a,b,c){return c?g(a,b):f(a,b)}function i(a,c){var d=a.length,e=d-1,f=0,g=b.pow,h;if(c)for(h=0;h<d;h++)f+=(255-a.charCodeAt(h))*g(256,e-h);else for(h=0;h<d;h++)f+=a.charCodeAt(h)*g(256,h);return f}function j(a,c,d,e){var f=b.pow,g=b.floor,h=j.convertFromBinary,i=j.convertToBinary,k=a/8,l=f(2,a),m=l/2,n=m-1,o=1/m,p=1/n;return e?d?c?function(a,b){return a=g(a<0?a*m+l:a*n),i(a,k,b)}:function(a,b){return i(g(a*n),k,b)}:c?function(a,b){return i(a<0?a+l:a,k,b)}:function(a,b){return i(a,k,b)}:d?c?function(a,b){var c=h(a,b);return c>n?(c-l)*o:c*p}:function(a,b){return h(a,b)*p}:c?function(a,b){var c=h(a,b);return c>n?c-l:c}:function(a,b){return h(a,b)}}var c=String.fromCharCode,d=!0,e=!1;j.convertToBinary=h,j.convertFromBinary=i,j.fromQ32=j(32,d,d,d),j.toQ32=j(32,d,d,e),j.fromQ24=j(24,d,d,d),j.toQ24=j(24,d,d,e),j.fromQ16=j(16,d,d,d),j.toQ16=j(16,d,d,e),j.fromQ8=j(8,d,d,d),j.toQ8=j(8,d,d,e),j.fromInt32=j(32,d,e,d),j.toInt32=j(32,d,e,e),j.fromInt16=j(16,d,e,d),j.toInt16=j(16,d,e,e),j.fromInt8=j(8,d,e,d),j.toInt8=j(8,d,e,e),j.fromUint32=j(32,e,e,d),j.toUint32=j(32,e,e,e),j.fromUint16=j(16,e,e,d),j.toUint16=j(16,e,e,e),j.fromUint8=j(8,e,e,d),j.toUint8=j(8,e,e,e),a.Binary=j})(this,Math),function(a,b){function c(a){this.data=a}function g(a,b,c){var e=b/8;d["read"+a+b]=function(a){return c(this.read(e),a)}}var d=c.prototype={read:function(a){var b=this,c=b.data.substr(0,a);return b.skip(a),c},skip:function(a){var b=this,c=b.data=b.data.substr(a);return b.pointer+=a,c.length},readBuffer:function(a,b,c){var d=this,e="read"+c+b,f=b/8,g=a.length,h=0;while(d.data&&h<g)a[h++]=d[e]();return h}},e,f;for(e in b)f=/to([a-z]+)([0-9]+)/i.exec(e),f&&g(f[1],f[2],b[e]);a.Stream=c,c.newType=g}(this,this.Binary),this.PCMData=function(a,b){function c(a){return(typeof a=="string"?c.decode:c.encode)(a)}return c.decodeFrame=function(a,c,d){if(c===8){var e=new(window.Uint8Array||Array)(d.length);(new b(a)).readBuffer(e,8,"Uint");for(c=0;c<d.length;c++)d[c]=(e[c]-127.5)*127.5}else(new b(a)).readBuffer(d,c,"Q");return d},c.encodeFrame=function(b,c){var d=a[(c===8?"fromUint":"fromQ")+c],e=b.length,f="",g;if(c===8)for(g=0;g<e;g++)f+=d(b[g]*127.5+127.5);else for(g=0;g<e;g++)f+=d(b[g]);return f},c.decode=function(a,d){function B(){s=e.read(4),t=e.readUint32(),v=e.read(t),x=z[s]=z[s]||[],s==="data"?(u=~~(t/q),w=A.data=new(typeof Float32Array!="undefined"?Float32Array:Array)(u),c.decodeFrame(v,q*8,w)):x.push(v),d&&(e.data?setTimeout(B,1):d(A))}var e=new b(a),f=e.read(4),g=e.readUint32();e=new b(e.read(g));var h=e.read(4),i=e.read(4),j=e.readUint32(),k=new b(e.read(j)),l=k.readUint16(),m=k.readUint16(),n=k.readUint32(),o=k.readUint32(),p=k.readUint16(),q=p/m,r=k.readUint16(),s,t,u,v,w,x,y,z={},A={channelCount:m,bytesPerSample:p/m,sampleRate:o/p,chunks:z,data:w};if(d)e.data?B():d(A);else while(e.data)B();return A},c.encode=function(b,d){var e=a.fromUint32,f=a.fromUint16,g=b.data,h=b.sampleRate,i=b.channelCount||1,j=b.bytesPerSample||1,k=j*8,l=i*j,m=h*l,n=g.length,o=n*j,p=Math.pow(2,k-1)-1,q=[],r="",s,t,u,v;q.push("fmt "+e(16)+f(1)+f(i)+e(h)+e(m)+f(l)+f(k)),q.push("data"+e(o)+c.encodeFrame(g,k)),v=b.chunks;if(v)for(t in v)if(v.hasOwnProperty(t)){s=v[t];for(u=0;u<s.length;u++)r=s[u],q.push(t+e(r.length)+r)}return q=q.join(""),q="RIFF"+e(q.length)+"WAVE"+q,d&&setTimeout(function(){d(q)},1),q},c}(this.Binary,this.Stream)