(function(a,b,c,d){a.widget("Mashup.audioPlayerWaveformViewer",a.Mashup.audioPlayer,{options:{waveformStart:0,waveformEnd:0},_advanceLoop:function(){this.noteTime+=this.duration},_create:function(){this.isGraphical=!1,a.Mashup.audioPlayer.prototype._create.call(this)},_playNote:function(a,b,c){this.source=this.context.createBufferSource(),this.buffer.gain=.4096,this.source.buffer=this.buffer;var d=this.source;d.connect(this.masterGainNode),this.source.noteGrainOn(a,b,c)},_setOption:function(a,b){switch(a){default:this.options[a]=b}this._super("_setOption",a,b)},addSample:function(a){this.buffer=a},play:function(){this.isLoaded=!0,this.noteTime=0,this.startTime=this.context.currentTime-this.noteTime+.005,this.duration=this.options.waveformEnd-this.options.waveformStart,this.schedule()},schedule:function(){var b=this.context.currentTime;b-=this.startTime;if(b<this.noteTime+this.duration&&b>this.noteTime){var c=this.noteTime+this.startTime,d=this.options.waveformStart;this._playNote(c,d,this.duration-.01),this._advanceLoop()}this.timeoutId=setTimeout("$('#"+a(this.element[0]).attr("id")+"').audioPlayerWaveformViewer('schedule')",0)},stop:function(){this.source.noteOff(0),clearTimeout(this.timeoutId)},_destroy:function(){}})})(jQuery,window,document)